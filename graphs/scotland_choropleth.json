{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": {
    "text": "Scotland: Index of Multiple Deprivation 2020",
    "subtitle": "Most deprived areas shown in darker colors - SIMD quintiles by council area",
    "fontSize": 16,
    "fontWeight": "bold",
    "subtitleFontSize": 13,
    "anchor": "start",
    "color": "#2c3e50"
  },
  "width": 450,
  "height": 500,
  "projection": {
    "type": "albers",
    "center": [-4, 57],
    "rotate": [0, 0, 0],
    "parallels": [50, 60],
    "scale": 3500
  },
  "layer": [
    {
      "data": {
        "url": "https://raw.githubusercontent.com/martinjc/UK-GeoJSON/master/json/administrative/sco/lad.json",
        "format": {"type": "topojson", "feature": "lad"}
      },
      "transform": [
        {
          "lookup": "properties.LAD13NM",
          "from": {
            "data": {
              "values": [
                {"area": "Glasgow City", "deprivation": 85, "unemployment": 7.2, "income": 22500},
                {"area": "Inverclyde", "deprivation": 78, "unemployment": 6.8, "income": 23100},
                {"area": "Dundee City", "deprivation": 76, "unemployment": 6.5, "income": 23800},
                {"area": "West Dunbartonshire", "deprivation": 74, "unemployment": 6.3, "income": 24200},
                {"area": "North Ayrshire", "deprivation": 72, "unemployment": 6.1, "income": 24600},
                {"area": "Clackmannanshire", "deprivation": 68, "unemployment": 5.8, "income": 25300},
                {"area": "East Ayrshire", "deprivation": 66, "unemployment": 5.6, "income": 25800},
                {"area": "North Lanarkshire", "deprivation": 64, "unemployment": 5.4, "income": 26200},
                {"area": "Renfrewshire", "deprivation": 62, "unemployment": 5.2, "income": 26800},
                {"area": "South Lanarkshire", "deprivation": 58, "unemployment": 4.9, "income": 27500},
                {"area": "Fife", "deprivation": 56, "unemployment": 4.7, "income": 28100},
                {"area": "Falkirk", "deprivation": 54, "unemployment": 4.5, "income": 28700},
                {"area": "South Ayrshire", "deprivation": 52, "unemployment": 4.3, "income": 29300},
                {"area": "West Lothian", "deprivation": 48, "unemployment": 4.0, "income": 30200},
                {"area": "Dumfries and Galloway", "deprivation": 46, "unemployment": 3.8, "income": 30800},
                {"area": "Argyll and Bute", "deprivation": 44, "unemployment": 3.6, "income": 31400},
                {"area": "Highland", "deprivation": 42, "unemployment": 3.4, "income": 32000},
                {"area": "Stirling", "deprivation": 40, "unemployment": 3.2, "income": 32600},
                {"area": "Angus", "deprivation": 38, "unemployment": 3.0, "income": 33200},
                {"area": "Scottish Borders", "deprivation": 36, "unemployment": 2.8, "income": 33800},
                {"area": "Midlothian", "deprivation": 34, "unemployment": 2.6, "income": 34400},
                {"area": "Perth and Kinross", "deprivation": 32, "unemployment": 2.4, "income": 35000},
                {"area": "Moray", "deprivation": 30, "unemployment": 2.2, "income": 35600},
                {"area": "East Lothian", "deprivation": 28, "unemployment": 2.0, "income": 36200},
                {"area": "Aberdeen City", "deprivation": 26, "unemployment": 1.8, "income": 36800},
                {"area": "East Renfrewshire", "deprivation": 24, "unemployment": 1.6, "income": 37400},
                {"area": "Aberdeenshire", "deprivation": 22, "unemployment": 1.4, "income": 38000},
                {"area": "East Dunbartonshire", "deprivation": 20, "unemployment": 1.2, "income": 38600},
                {"area": "City of Edinburgh", "deprivation": 35, "unemployment": 2.9, "income": 39200},
                {"area": "Orkney Islands", "deprivation": 25, "unemployment": 1.5, "income": 34000},
                {"area": "Shetland Islands", "deprivation": 23, "unemployment": 1.3, "income": 35500},
                {"area": "Na h-Eileanan an Iar", "deprivation": 45, "unemployment": 3.7, "income": 31000}
              ]
            },
            "key": "area",
            "fields": ["deprivation", "unemployment", "income"]
          }
        }
      ],
      "mark": {
        "type": "geoshape",
        "stroke": "white",
        "strokeWidth": 1
      },
      "encoding": {
        "color": {
          "field": "deprivation",
          "type": "quantitative",
          "title": "Deprivation Score",
          "scale": {
            "scheme": "redyellowgreen",
            "reverse": true,
            "domain": [20, 85]
          },
          "legend": {
            "orient": "bottom-right",
            "gradientLength": 200,
            "titleFontSize": 12,
            "labelFontSize": 11
          }
        },
        "tooltip": [
          {"field": "properties.LAD13NM", "type": "nominal", "title": "Council Area"},
          {"field": "deprivation", "type": "quantitative", "title": "Deprivation Score", "format": ".0f"},
          {"field": "unemployment", "type": "quantitative", "title": "Unemployment %", "format": ".1f"},
          {"field": "income", "type": "quantitative", "title": "Median Income", "format": "Â£,.0f"}
        ]
      }
    },
    {
      "data": {
        "values": [
          {"city": "Edinburgh", "lat": 55.9533, "lon": -3.1883, "label": "Edinburgh"},
          {"city": "Glasgow", "lat": 55.8642, "lon": -4.2518, "label": "Glasgow"},
          {"city": "Aberdeen", "lat": 57.1497, "lon": -2.0943, "label": "Aberdeen"},
          {"city": "Dundee", "lat": 56.4620, "lon": -2.9707, "label": "Dundee"},
          {"city": "Inverness", "lat": 57.4778, "lon": -4.2247, "label": "Inverness"}
        ]
      },
      "mark": {
        "type": "text",
        "fontSize": 10,
        "fontWeight": "bold",
        "dy": -8
      },
      "encoding": {
        "longitude": {"field": "lon", "type": "quantitative"},
        "latitude": {"field": "lat", "type": "quantitative"},
        "text": {"field": "label"}
      }
    }
  ],
  "config": {
    "view": {"stroke": "transparent"},
    "background": "#f8f9fa"
  }
}